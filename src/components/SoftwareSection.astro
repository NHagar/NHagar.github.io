---
import type { CollectionEntry } from "astro:content";
import SoftwareCard from "./SoftwareCard.astro";
import { Icon } from "astro-icon/components";

interface Props {
    softwareItems: CollectionEntry<"software">[];
}

const { softwareItems } = Astro.props;

// Optional: Add statistics or metrics
const totalProjects = softwareItems.length;
const languages = ["Python", "TypeScript", "JavaScript"]; // You could extract this from your data
---

<section aria-labelledby="software-heading" class="animate-section relative">
    <!-- Decorative code pattern background -->
    <div class="absolute inset-0 opacity-5">
        <div class="absolute top-10 left-10 font-mono text-primary-600 text-sm">
            <pre>{'<code>'}</pre>
        </div>
        <div class="absolute bottom-10 right-10 font-mono text-accent-purple text-sm">
            <pre>{'</code>'}</pre>
        </div>
        <div class="absolute top-1/2 left-1/3 font-mono text-primary-400 text-xs">
            <pre>npm install</pre>
        </div>
        <div class="absolute top-1/3 right-1/4 font-mono text-accent-pink text-xs">
            <pre>git commit</pre>
        </div>
    </div>
    
    <div class="relative">
        <!-- Section header with animated icon -->
        <div class="flex items-center justify-between mb-10">
            <div class="flex items-center gap-4">
                <div class="relative">
                    <div class="absolute inset-0 bg-gradient-to-br from-primary-500 to-accent-purple rounded-xl blur animate-pulse"></div>
                    <div class="relative p-3 rounded-xl bg-gradient-to-br from-primary-500 to-accent-purple text-white shadow-lg">
                        <Icon name="mdi:code-braces" class="w-6 h-6" />
                    </div>
                </div>
                <h2 id="software-heading" class="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-primary-600 via-accent-purple to-accent-pink bg-clip-text text-transparent animate-gradient bg-300%">
                    Software & Code
                </h2>
            </div>
            <div class="h-0.5 flex-1 ml-6 bg-gradient-to-r from-primary-200 to-transparent"></div>
        </div>

        {softwareItems && softwareItems.length > 0 ? (
            <>
                <!-- Stats bar -->
                <div class="flex flex-wrap gap-4 justify-center md:justify-start mb-8">
                    <div class="flex items-center gap-2 px-4 py-2 rounded-full bg-primary-50 border border-primary-200">
                        <Icon name="mdi:folder-open" class="w-4 h-4 text-primary-600" />
                        <span class="text-sm font-medium text-primary-700">{totalProjects} Projects</span>
                    </div>
                    {languages.map((lang) => (
                        <div class="flex items-center gap-2 px-4 py-2 rounded-full bg-white border border-gray-200">
                            <div class="w-2 h-2 rounded-full bg-gradient-to-r from-primary-400 to-accent-purple"></div>
                            <span class="text-sm text-text-secondary">{lang}</span>
                        </div>
                    ))}
                </div>
                
                <!-- Software grid with hover effects -->
                <div class="grid md:grid-cols-2 gap-6 lg:gap-8">
                    {softwareItems.map((itemEntry, index) => (
                        <div 
                            class="animate-scale-in" 
                            style={`animation-delay: ${0.1 * index}s;`}
                        >
                            <SoftwareCard item={itemEntry.data} />
                        </div>
                    ))}
                </div>
                
                <!-- GitHub CTA with enhanced styling -->
                <div class="mt-12 text-center">
                    <div class="inline-block relative">
                        <!-- Glow effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-primary-400 to-accent-purple rounded-full blur-lg opacity-50 animate-pulse"></div>
                        
                        <a
                            href="https://github.com/NHagar"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="relative group inline-flex items-center gap-3 px-8 py-4 rounded-full bg-gradient-to-r from-gray-900 to-gray-800 text-white font-medium shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-0.5"
                        >
                            <Icon name="mdi:github" class="w-6 h-6" />
                            <span>Explore all projects on GitHub</span>
                            <Icon name="mdi:arrow-right" class="w-5 h-5 transition-transform duration-300 group-hover:translate-x-1" />
                        </a>
                    </div>
                    
                    <!-- Additional context -->
                    <p class="mt-6 text-sm text-text-tertiary">
                        Open source contributions and experiments in 
                        <span class="font-medium text-primary-600">data science</span>, 
                        <span class="font-medium text-accent-purple">web scraping</span>, and 
                        <span class="font-medium text-accent-pink">journalism tools</span>
                    </p>
                </div>
            </>
        ) : (
            <div class="text-center py-12">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-primary-100 to-accent-purple/20 mb-4">
                    <Icon name="mdi:code-off" class="w-8 h-8 text-primary-600" />
                </div>
                <p class="text-text-secondary">
                    No software projects to display at the moment.
                </p>
                <p class="text-sm text-text-tertiary mt-2">
                    New code coming soon!
                </p>
            </div>
        )}
    </div>
</section>