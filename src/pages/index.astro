---
import MainLayout from "../layouts/MainLayout.astro";
import Header from "../components/Header.astro";
import Bio from "../components/Bio.astro";
import ResearchFocus from "../components/ResearchFocus.astro";
import UpdatesSection from "../components/UpdatesSection.astro";
import SoftwareSection from "../components/SoftwareSection.astro";
import PapersSection from "../components/PapersSection.astro";
import BlogSection from "../components/BlogSection.astro";
import MentionsSection from "../components/MentionsSection.astro";
import PrototypesSection from "../components/PrototypesSection.astro";

import { getCollection } from "astro:content";

const blogsCollection = await getCollection("blog");
const papersCollection = await getCollection("papers");
const softwareCollection = await getCollection("software");
const prototypesCollection = await getCollection("prototypes");
const mentionsCollection = await getCollection("mentions");
const updatesCollection = await getCollection("updates");

const pageTitle = "Nick Hagar | Research, Code, Writing";
const pageDescription =
	"Personal website of Nick Hagar, postdoctoral scholar focusing on collective attention, generative AI, and computational journalism.";
---

<MainLayout title={pageTitle} description={pageDescription}>
	<!-- Enhanced decorative background -->
	<div class="fixed inset-0 -z-10 overflow-hidden">
		<!-- Gradient mesh background -->
		<div class="absolute inset-0 bg-gradient-mesh opacity-5"></div>

		<!-- Animated gradient orbs -->
		<div
			class="absolute top-1/4 -left-64 w-96 h-96 bg-gradient-to-br from-primary-300 to-accent-purple rounded-full blur-3xl opacity-10 animate-float"
		>
		</div>
		<div
			class="absolute bottom-1/4 -right-64 w-96 h-96 bg-gradient-to-br from-accent-pink to-accent-orange rounded-full blur-3xl opacity-10 animate-float"
			style="animation-delay: 4s;"
		>
		</div>

		<!-- Subtle grid pattern -->
		<div
			class="absolute inset-0 opacity-5"
			style="background-image: url('data:image/svg+xml;utf8,<svg width=\"
			60\"
			height='\"60\"'
			viewBox='\"0'
			0
			60
			60\"
			xmlns='\"http://www.w3.org/2000/svg\"'
		>
			<defs
				><pattern
					id='\"grid\"'
					width='\"60\"'
					height='\"60\"'
					patternUnits='\"userSpaceOnUse\"'
					><path
						d='\"M'
						60
						0
						L
						0
						0
						0
						60\"
						fill='\"none\"'
						stroke='\"%23e5e7eb\"'
						stroke-width='\"1\"/'></path></pattern
				></defs
			><rect width='\"100%\"' height='\"100%\"' fill='\"url(%23grid)\"/'
			></rect>
		</div>');" >
	</div>
</MainLayout>

<div
	class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl py-8 md:py-12 relative"
>
	<Header />

	<main class="mt-16 space-y-24 md:space-y-32">
		<!-- Each section gets proper spacing and animation -->
		<Bio />
		<ResearchFocus />
		<UpdatesSection updates={updatesCollection} />
		<SoftwareSection softwareItems={softwareCollection} />
		<PapersSection papers={papersCollection} />
		<BlogSection posts={blogsCollection} />
		<MentionsSection mentions={mentionsCollection} />
		<PrototypesSection prototypes={prototypesCollection} />
	</main>

	<!-- Enhanced footer -->
	<footer class="mt-32 py-12 relative">
		<div
			class="absolute inset-0 bg-gradient-to-t from-primary-50/50 to-transparent"
		>
		</div>
		<div class="relative text-center space-y-4">
			<div
				class="flex items-center justify-center gap-2 text-sm text-text-tertiary"
			>
				<span>© {new Date().getFullYear()} Nick Hagar</span>
				<span class="text-primary-300">•</span>
				<span>Built with</span>
				<span class="text-primary-600">♥</span>
				<span>using</span>
				<a
					href="https://astro.build"
					target="_blank"
					rel="noopener noreferrer"
					class="font-medium text-primary-600 hover:text-accent-purple transition-colors"
				>
					Astro
				</a>
			</div>
			<p class="text-xs text-text-tertiary">
				Researching the future of attention, AI, and journalism
			</p>
		</div>
	</footer>
</div>
